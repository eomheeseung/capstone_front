{"ast":null,"code":"import _slicedToArray from \"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _regeneratorRuntime from \"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _classCallCheck from \"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport m from \"pino\";\nimport f from \"@walletconnect/sign-client\";\nimport { getSdkError as g, isValidArray as P } from \"@walletconnect/utils\";\nimport { getDefaultLoggerOptions as w } from \"@walletconnect/logger\";\nimport { JsonRpcProvider as a } from \"@walletconnect/jsonrpc-provider\";\nimport c, { HttpConnection as C } from \"@walletconnect/jsonrpc-http-connection\";\nimport I from \"events\";\nfunction y(i) {\n  var t;\n  var e = (t = i[Object.keys(i)[0]]) == null ? void 0 : t.chains[0];\n  return [e.split(\":\")[0], e.split(\":\")[1]];\n}\nfunction r(i, t) {\n  var e;\n  return t.rpcMap && (e = t.rpcMap[O([i])]), e;\n}\nfunction O(i) {\n  return Number(i[0].split(\":\")[1]);\n}\nvar E = /*#__PURE__*/function () {\n  function E(t) {\n    _classCallCheck(this, E);\n    this.name = \"eip155\", this.namespace = t.namespace, this.client = t.client, this.events = t.events, this.httpProviders = this.createHttpProviders(), this.chainId = this.getDefaultChainId();\n  }\n  _createClass(E, [{\n    key: \"request\",\n    value: function () {\n      var _request = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(t) {\n        var e, s;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = t.request.method;\n              _context.next = _context.t0 === \"eth_requestAccounts\" ? 3 : _context.t0 === \"eth_accounts\" ? 4 : _context.t0 === \"wallet_switchEthereumChain\" ? 5 : _context.t0 === \"eth_chainId\" ? 7 : 8;\n              break;\n            case 3:\n              return _context.abrupt(\"return\", this.getAccounts());\n            case 4:\n              return _context.abrupt(\"return\", this.getAccounts());\n            case 5:\n              s = t.request.params ? (e = t.request.params[0]) == null ? void 0 : e.chainId : \"0x0\";\n              return _context.abrupt(\"return\", (this.setDefaultChain(parseInt(s, 16).toString()), null));\n            case 7:\n              return _context.abrupt(\"return\", this.getDefaultChainId());\n            case 8:\n              if (!this.namespace.methods.includes(t.request.method)) {\n                _context.next = 14;\n                break;\n              }\n              _context.next = 11;\n              return this.client.request(t);\n            case 11:\n              _context.t1 = _context.sent;\n              _context.next = 15;\n              break;\n            case 14:\n              _context.t1 = this.getHttpProvider().request(t.request);\n            case 15:\n              return _context.abrupt(\"return\", _context.t1);\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function request(_x) {\n        return _request.apply(this, arguments);\n      }\n      return request;\n    }()\n  }, {\n    key: \"updateNamespace\",\n    value: function updateNamespace(t) {\n      this.namespace = Object.assign(this.namespace, t);\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(t, e) {\n      if (this.chainId = parseInt(t), !this.httpProviders[t]) {\n        var s = e || r(\"\".concat(this.name, \":\").concat(t), this.namespace);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(t));\n        this.setHttpProvider(t, s);\n      }\n      this.events.emit(\"chainChanged\", this.chainId);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(t, e) {\n      var s = e || r(t, this.namespace);\n      return typeof s > \"u\" ? void 0 : new a(new C(s));\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(t, e) {\n      var s = this.createHttpProvider(t, e);\n      s && (this.httpProviders[t] = s);\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this = this;\n      var t = {};\n      return this.namespace.chains.forEach(function (e) {\n        t[e] = _this.createHttpProvider(e);\n      }), t;\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this2 = this;\n      var t = this.namespace.accounts;\n      return t ? t.filter(function (e) {\n        return e.split(\":\")[1] === _this2.chainId.toString();\n      }).map(function (e) {\n        return e.split(\":\")[2];\n      }) || [] : [];\n    }\n  }, {\n    key: \"getDefaultChainId\",\n    value: function getDefaultChainId() {\n      if (this.chainId) return this.chainId;\n      var t = this.namespace.chains[0];\n      if (!t) throw new Error(\"ChainId not found\");\n      return parseInt(t.split(\":\")[1]);\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var t = \"\".concat(this.name, \":\").concat(this.chainId),\n        e = this.httpProviders[t];\n      if (typeof e > \"u\") throw new Error(\"JSON-RPC provider for \".concat(t, \" not found\"));\n      return e;\n    }\n  }]);\n  return E;\n}();\nvar q = /*#__PURE__*/function () {\n  function q(t) {\n    _classCallCheck(this, q);\n    this.name = \"solana\", this.namespace = t.namespace, this.events = t.events, this.client = t.client, this.chainId = this.getDefaultChainId(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(q, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(t) {\n      this.namespace = Object.assign(this.namespace, t);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this3 = this;\n      var t = this.namespace.accounts;\n      return t ? t.filter(function (e) {\n        return e.split(\":\")[1] === _this3.chainId.toString();\n      }).map(function (e) {\n        return e.split(\":\")[2];\n      }) || [] : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this4 = this;\n      var t = {};\n      return this.namespace.chains.forEach(function (e) {\n        t[e] = _this4.createHttpProvider(e);\n      }), t;\n    }\n  }, {\n    key: \"getDefaultChainId\",\n    value: function getDefaultChainId() {\n      if (this.chainId) return this.chainId;\n      var t = this.namespace.chains[0];\n      if (!t) throw new Error(\"ChainId not found\");\n      return t.split(\":\")[1];\n    }\n  }, {\n    key: \"request\",\n    value: function request(t) {\n      return this.namespace.methods.includes(t.request.method) ? this.client.request(t) : this.getHttpProvider().request(t.request);\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var t = \"\".concat(this.name, \":\").concat(this.chainId),\n        e = this.httpProviders[t];\n      if (typeof e > \"u\") throw new Error(\"JSON-RPC provider for \".concat(t, \" not found\"));\n      return e;\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(t, e) {\n      if (this.chainId = t, !this.httpProviders[t]) {\n        var s = e || r(\"\".concat(this.name, \":\").concat(t), this.namespace);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(t));\n        this.setHttpProvider(t, s);\n      }\n      this.events.emit(\"chainChanged\", this.chainId);\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(t, e) {\n      var s = this.createHttpProvider(t, e);\n      s && (this.httpProviders[t] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(t, e) {\n      var s = e || r(t, this.namespace);\n      return typeof s > \"u\" ? void 0 : new a(new c(s));\n    }\n  }]);\n  return q;\n}();\nvar H = /*#__PURE__*/function () {\n  function H(t) {\n    _classCallCheck(this, H);\n    this.name = \"cosmos\", this.namespace = t.namespace, this.events = t.events, this.client = t.client, this.chainId = this.getDefaultChainId(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass(H, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(t) {\n      this.namespace = Object.assign(this.namespace, t);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this5 = this;\n      var t = this.namespace.accounts;\n      return t ? t.filter(function (e) {\n        return e.split(\":\")[1] === _this5.chainId.toString();\n      }).map(function (e) {\n        return e.split(\":\")[2];\n      }) || [] : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this6 = this;\n      var t = {};\n      return this.namespace.chains.forEach(function (e) {\n        t[e] = _this6.createHttpProvider(e);\n      }), t;\n    }\n  }, {\n    key: \"getDefaultChainId\",\n    value: function getDefaultChainId() {\n      if (this.chainId) return this.chainId;\n      var t = this.namespace.chains[0];\n      if (!t) throw new Error(\"ChainId not found\");\n      return t.split(\":\")[1];\n    }\n  }, {\n    key: \"request\",\n    value: function request(t) {\n      return this.namespace.methods.includes(t.request.method) ? this.client.request(t) : this.getHttpProvider().request(t.request);\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var t = \"\".concat(this.name, \":\").concat(this.chainId),\n        e = this.httpProviders[t];\n      if (typeof e > \"u\") throw new Error(\"JSON-RPC provider for \".concat(t, \" not found\"));\n      return e;\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(t, e) {\n      if (this.chainId = t, !this.httpProviders[t]) {\n        var s = e || r(\"\".concat(this.name, \":\").concat(t), this.namespace);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(t));\n        this.setHttpProvider(t, s);\n      }\n      this.events.emit(\"chainChanged\", this.chainId);\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(t, e) {\n      var s = this.createHttpProvider(t, e);\n      s && (this.httpProviders[t] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(t, e) {\n      var s = e || r(t, this.namespace);\n      return typeof s > \"u\" ? void 0 : new a(new c(s));\n    }\n  }]);\n  return H;\n}();\nvar $ = /*#__PURE__*/function () {\n  function $(t) {\n    _classCallCheck(this, $);\n    this.name = \"cip34\", this.namespace = t.namespace, this.events = t.events, this.client = t.client, this.chainId = this.getDefaultChainId(), this.httpProviders = this.createHttpProviders();\n  }\n  _createClass($, [{\n    key: \"updateNamespace\",\n    value: function updateNamespace(t) {\n      this.namespace = Object.assign(this.namespace, t);\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function requestAccounts() {\n      return this.getAccounts();\n    }\n  }, {\n    key: \"getAccounts\",\n    value: function getAccounts() {\n      var _this7 = this;\n      var t = this.namespace.accounts;\n      return t ? t.filter(function (e) {\n        return e.split(\":\")[1] === _this7.chainId.toString();\n      }).map(function (e) {\n        return e.split(\":\")[2];\n      }) || [] : [];\n    }\n  }, {\n    key: \"createHttpProviders\",\n    value: function createHttpProviders() {\n      var _this8 = this;\n      var t = {};\n      return this.namespace.chains.forEach(function (e) {\n        t[e] = _this8.createHttpProvider(e);\n      }), t;\n    }\n  }, {\n    key: \"getDefaultChainId\",\n    value: function getDefaultChainId() {\n      if (this.chainId) return this.chainId;\n      var t = this.namespace.chains[0];\n      if (!t) throw new Error(\"ChainId not found\");\n      return t.split(\":\")[1];\n    }\n  }, {\n    key: \"request\",\n    value: function request(t) {\n      return this.namespace.methods.includes(t.request.method) ? this.client.request(t) : this.getHttpProvider().request(t.request);\n    }\n  }, {\n    key: \"getHttpProvider\",\n    value: function getHttpProvider() {\n      var t = \"\".concat(this.name, \":\").concat(this.chainId),\n        e = this.httpProviders[t];\n      if (typeof e > \"u\") throw new Error(\"JSON-RPC provider for \".concat(t, \" not found\"));\n      return e;\n    }\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(t, e) {\n      if (this.chainId = t, !this.httpProviders[t]) {\n        var s = e || r(\"\".concat(this.name, \":\").concat(t), this.namespace);\n        if (!s) throw new Error(\"No RPC url provided for chainId: \".concat(t));\n        this.setHttpProvider(t, s);\n      }\n      this.events.emit(\"chainChanged\", this.chainId);\n    }\n  }, {\n    key: \"setHttpProvider\",\n    value: function setHttpProvider(t, e) {\n      var s = this.createHttpProvider(t, e);\n      s && (this.httpProviders[t] = s);\n    }\n  }, {\n    key: \"createHttpProvider\",\n    value: function createHttpProvider(t, e) {\n      var s = e || r(t, this.namespace);\n      return typeof s > \"u\" ? void 0 : new a(new c(s));\n    }\n  }]);\n  return $;\n}();\nvar h = \"error\",\n  b = \"wss://relay.walletconnect.com\",\n  S = \"wc\",\n  A = \"universal_provider\",\n  p = \"\".concat(S, \"@\", 2, \":\").concat(A, \":\");\nvar N = Object.defineProperty,\n  D = Object.defineProperties,\n  j = Object.getOwnPropertyDescriptors,\n  d = Object.getOwnPropertySymbols,\n  k = Object.prototype.hasOwnProperty,\n  R = Object.prototype.propertyIsEnumerable,\n  l = function l(i, t, e) {\n    return t in i ? N(i, t, {\n      enumerable: !0,\n      configurable: !0,\n      writable: !0,\n      value: e\n    }) : i[t] = e;\n  },\n  u = function u(i, t) {\n    for (var e in t || (t = {})) k.call(t, e) && l(i, e, t[e]);\n    if (d) {\n      var _iterator = _createForOfIteratorHelper(d(t)),\n        _step;\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var e = _step.value;\n          R.call(t, e) && l(i, e, t[e]);\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }\n    return i;\n  },\n  _ = function _(i, t) {\n    return D(i, j(t));\n  };\nvar o = /*#__PURE__*/function () {\n  function o(t) {\n    _classCallCheck(this, o);\n    this.events = new I(), this.rpcProviders = {}, this.providerOpts = t, this.logger = typeof (t === null || t === void 0 ? void 0 : t.logger) < \"u\" && typeof (t === null || t === void 0 ? void 0 : t.logger) != \"string\" ? t.logger : m(w({\n      level: (t === null || t === void 0 ? void 0 : t.logger) || h\n    }));\n  }\n  _createClass(o, [{\n    key: \"request\",\n    value: function () {\n      var _request2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(t, e) {\n        var _this$validateChain, _this$validateChain2, s, n;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _this$validateChain = this.validateChain(e), _this$validateChain2 = _slicedToArray(_this$validateChain, 2), s = _this$validateChain2[0], n = _this$validateChain2[1];\n              if (this.session) {\n                _context2.next = 3;\n                break;\n              }\n              throw new Error(\"Please call connect() before request()\");\n            case 3:\n              _context2.next = 5;\n              return this.getProvider(s).request({\n                request: u({}, t),\n                chainId: \"\".concat(s, \":\").concat(n),\n                topic: this.session.topic\n              });\n            case 5:\n              return _context2.abrupt(\"return\", _context2.sent);\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function request(_x2, _x3) {\n        return _request2.apply(this, arguments);\n      }\n      return request;\n    }()\n  }, {\n    key: \"sendAsync\",\n    value: function sendAsync(t, e, s) {\n      this.request(t, s).then(function (n) {\n        return e(null, n);\n      }).catch(function (n) {\n        return e(n, void 0);\n      });\n    }\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              if (this.client) {\n                _context3.next = 2;\n                break;\n              }\n              throw new Error(\"Sign Client not initialized\");\n            case 2:\n              _context3.t0 = this.session;\n              if (_context3.t0) {\n                _context3.next = 6;\n                break;\n              }\n              _context3.next = 6;\n              return this.connect({\n                namespaces: this.namespaces\n              });\n            case 6:\n              _context3.next = 8;\n              return this.requestAccounts();\n            case 8:\n              return _context3.abrupt(\"return\", _context3.sent);\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this);\n      }));\n      function enable() {\n        return _enable.apply(this, arguments);\n      }\n      return enable;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var t;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (this.session) {\n                _context4.next = 2;\n                break;\n              }\n              throw new Error(\"Please call connect() before enable()\");\n            case 2:\n              _context4.next = 4;\n              return this.client.disconnect({\n                topic: (t = this.session) == null ? void 0 : t.topic,\n                reason: g(\"USER_DISCONNECTED\")\n              });\n            case 4:\n              _context4.next = 6;\n              return this.cleanup();\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n      return disconnect;\n    }()\n  }, {\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(t) {\n        var e;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              if (this.client) {\n                _context5.next = 2;\n                break;\n              }\n              throw new Error(\"Sign Client not initialized\");\n            case 2:\n              e = t.namespaces;\n              this.setNamespaces(e);\n              this.createProviders();\n              _context5.next = 7;\n              return this.cleanupPendingPairings();\n            case 7:\n              if (!(t.skipPairing === !0)) {\n                _context5.next = 11;\n                break;\n              }\n              _context5.t0 = void 0;\n              _context5.next = 14;\n              break;\n            case 11:\n              _context5.next = 13;\n              return this.pair(t.pairingTopic);\n            case 13:\n              _context5.t0 = _context5.sent;\n            case 14:\n              return _context5.abrupt(\"return\", _context5.t0);\n            case 15:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function connect(_x4) {\n        return _connect.apply(this, arguments);\n      }\n      return connect;\n    }()\n  }, {\n    key: \"on\",\n    value: function on(t, e) {\n      this.events.on(t, e);\n    }\n  }, {\n    key: \"once\",\n    value: function once(t, e) {\n      this.events.once(t, e);\n    }\n  }, {\n    key: \"removeListener\",\n    value: function removeListener(t, e) {\n      this.events.removeListener(t, e);\n    }\n  }, {\n    key: \"off\",\n    value: function off(t, e) {\n      this.events.off(t, e);\n    }\n  }, {\n    key: \"isWalletConnect\",\n    get: function get() {\n      return !0;\n    }\n  }, {\n    key: \"pair\",\n    value: function () {\n      var _pair = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(t) {\n        var _yield$this$client$co, e, s;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return this.client.connect({\n                pairingTopic: t,\n                requiredNamespaces: this.namespaces\n              });\n            case 2:\n              _yield$this$client$co = _context6.sent;\n              e = _yield$this$client$co.uri;\n              s = _yield$this$client$co.approval;\n              e && (this.uri = e, this.events.emit(\"display_uri\", e));\n              _context6.next = 8;\n              return s();\n            case 8:\n              this.session = _context6.sent;\n              this.onSessionUpdate();\n              this.onConnect();\n              return _context6.abrupt(\"return\", this.session);\n            case 12:\n            case \"end\":\n              return _context6.stop();\n          }\n        }, _callee6, this);\n      }));\n      function pair(_x5) {\n        return _pair.apply(this, arguments);\n      }\n      return pair;\n    }()\n  }, {\n    key: \"setDefaultChain\",\n    value: function setDefaultChain(t, e) {\n      try {\n        var _this$validateChain3 = this.validateChain(t),\n          _this$validateChain4 = _slicedToArray(_this$validateChain3, 2),\n          s = _this$validateChain4[0],\n          n = _this$validateChain4[1];\n        this.getProvider(s).setDefaultChain(n, e);\n      } catch (s) {\n        if (!/Please call connect/.test(s.message)) throw s;\n      }\n    }\n  }, {\n    key: \"cleanupPendingPairings\",\n    value: function () {\n      var _cleanupPendingPairings = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var t,\n          e,\n          _iterator2,\n          _step2,\n          s,\n          _args7 = arguments;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) switch (_context7.prev = _context7.next) {\n            case 0:\n              t = _args7.length > 0 && _args7[0] !== undefined ? _args7[0] : {};\n              this.logger.info(\"Cleaning up inactive pairings...\");\n              e = this.client.pairing.getAll();\n              if (!P(e)) {\n                _context7.next = 26;\n                break;\n              }\n              _iterator2 = _createForOfIteratorHelper(e);\n              _context7.prev = 5;\n              _iterator2.s();\n            case 7:\n              if ((_step2 = _iterator2.n()).done) {\n                _context7.next = 17;\n                break;\n              }\n              s = _step2.value;\n              if (!t.deletePairings) {\n                _context7.next = 13;\n                break;\n              }\n              this.client.core.expirer.set(s.topic, 0);\n              _context7.next = 15;\n              break;\n            case 13:\n              _context7.next = 15;\n              return this.client.core.relayer.subscriber.unsubscribe(s.topic);\n            case 15:\n              _context7.next = 7;\n              break;\n            case 17:\n              _context7.next = 22;\n              break;\n            case 19:\n              _context7.prev = 19;\n              _context7.t0 = _context7[\"catch\"](5);\n              _iterator2.e(_context7.t0);\n            case 22:\n              _context7.prev = 22;\n              _iterator2.f();\n              return _context7.finish(22);\n            case 25:\n              this.logger.info(\"Inactive pairings cleared: \".concat(e.length));\n            case 26:\n            case \"end\":\n              return _context7.stop();\n          }\n        }, _callee7, this, [[5, 19, 22, 25]]);\n      }));\n      function cleanupPendingPairings() {\n        return _cleanupPendingPairings.apply(this, arguments);\n      }\n      return cleanupPendingPairings;\n    }()\n  }, {\n    key: \"checkStorage\",\n    value: function () {\n      var _checkStorage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8() {\n        var t;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) switch (_context8.prev = _context8.next) {\n            case 0:\n              _context8.next = 2;\n              return this.client.core.storage.getItem(\"\".concat(p, \"/namespaces\"));\n            case 2:\n              _context8.t0 = _context8.sent;\n              if (_context8.t0) {\n                _context8.next = 5;\n                break;\n              }\n              _context8.t0 = {};\n            case 5:\n              this.namespaces = _context8.t0;\n              this.namespaces && this.createProviders();\n              if (!this.client.session.length) {\n                _context8.next = 10;\n                break;\n              }\n              t = this.client.session.keys.length - 1;\n              this.session = this.client.session.get(this.client.session.keys[t]), this.onSessionUpdate();\n            case 10:\n            case \"end\":\n              return _context8.stop();\n          }\n        }, _callee8, this);\n      }));\n      function checkStorage() {\n        return _checkStorage.apply(this, arguments);\n      }\n      return checkStorage;\n    }()\n  }, {\n    key: \"initialize\",\n    value: function () {\n      var _initialize = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) switch (_context9.prev = _context9.next) {\n            case 0:\n              this.logger.trace(\"Initialized\");\n              _context9.next = 3;\n              return this.createClient();\n            case 3:\n              this.checkStorage();\n              this.registerEventListeners();\n            case 5:\n            case \"end\":\n              return _context9.stop();\n          }\n        }, _callee9, this);\n      }));\n      function initialize() {\n        return _initialize.apply(this, arguments);\n      }\n      return initialize;\n    }()\n  }, {\n    key: \"createClient\",\n    value: function () {\n      var _createClient = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) switch (_context10.prev = _context10.next) {\n            case 0:\n              _context10.t0 = this.providerOpts.client;\n              if (_context10.t0) {\n                _context10.next = 5;\n                break;\n              }\n              _context10.next = 4;\n              return f.init({\n                logger: this.providerOpts.logger || h,\n                relayUrl: this.providerOpts.relayUrl || b,\n                projectId: this.providerOpts.projectId,\n                metadata: this.providerOpts.metadata,\n                storageOptions: this.providerOpts.storageOptions,\n                name: this.providerOpts.name\n              });\n            case 4:\n              _context10.t0 = _context10.sent;\n            case 5:\n              this.client = _context10.t0;\n              this.logger.trace(\"SignClient Initialized\");\n            case 7:\n            case \"end\":\n              return _context10.stop();\n          }\n        }, _callee10, this);\n      }));\n      function createClient() {\n        return _createClient.apply(this, arguments);\n      }\n      return createClient;\n    }()\n  }, {\n    key: \"createProviders\",\n    value: function createProviders() {\n      var _this9 = this;\n      if (!this.client) throw new Error(\"Sign Client not initialized\");\n      Object.keys(this.namespaces).forEach(function (t) {\n        switch (t) {\n          case \"eip155\":\n            _this9.rpcProviders[t] = new E({\n              client: _this9.client,\n              namespace: _this9.namespaces[t],\n              events: _this9.events\n            });\n            break;\n          case \"solana\":\n            _this9.rpcProviders[t] = new q({\n              client: _this9.client,\n              namespace: _this9.namespaces[t],\n              events: _this9.events\n            });\n            break;\n          case \"cosmos\":\n            _this9.rpcProviders[t] = new H({\n              client: _this9.client,\n              namespace: _this9.namespaces[t],\n              events: _this9.events\n            });\n            break;\n          case \"polkadot\":\n            break;\n          case \"cip34\":\n            _this9.rpcProviders[t] = new $({\n              client: _this9.client,\n              namespace: _this9.namespaces[t],\n              events: _this9.events\n            });\n            break;\n        }\n      });\n    }\n  }, {\n    key: \"registerEventListeners\",\n    value: function registerEventListeners() {\n      var _this10 = this;\n      if (typeof this.client > \"u\") throw new Error(\"Sign Client is not initialized\");\n      this.client.on(\"session_ping\", function (t) {\n        _this10.events.emit(\"session_ping\", t);\n      }), this.client.on(\"session_event\", function (t) {\n        var e = t.params,\n          s = e.event;\n        s.name === \"accountsChanged\" ? _this10.events.emit(\"accountsChanged\", s.data) : s.name === \"chainChanged\" ? _this10.onChainChanged(s.data, e.chainId) : _this10.events.emit(s.name, s.data), _this10.events.emit(\"session_event\", t);\n      }), this.client.on(\"session_update\", function (_ref) {\n        var t = _ref.topic,\n          e = _ref.params;\n        var s;\n        var n = e.namespaces,\n          v = (s = _this10.client) == null ? void 0 : s.session.get(t);\n        _this10.session = _(u({}, v), {\n          namespaces: n\n        }), _this10.onSessionUpdate(), _this10.events.emit(\"session_update\", {\n          topic: t,\n          params: e\n        });\n      }), this.client.on(\"session_delete\", /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(t) {\n          return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n            while (1) switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return _this10.cleanup();\n              case 2:\n                _this10.events.emit(\"session_delete\", t);\n              case 3:\n              case \"end\":\n                return _context11.stop();\n            }\n          }, _callee11);\n        }));\n        return function (_x6) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    }\n  }, {\n    key: \"getProvider\",\n    value: function getProvider(t) {\n      if (!this.rpcProviders[t]) throw new Error(\"Provider not found: \".concat(t));\n      return this.rpcProviders[t];\n    }\n  }, {\n    key: \"onSessionUpdate\",\n    value: function onSessionUpdate() {\n      var _this11 = this;\n      Object.keys(this.rpcProviders).forEach(function (t) {\n        var e;\n        _this11.getProvider(t).updateNamespace((e = _this11.session) == null ? void 0 : e.namespaces[t]);\n      });\n    }\n  }, {\n    key: \"setNamespaces\",\n    value: function setNamespaces(t) {\n      if (!t || !Object.keys(t).length) throw new Error(\"Namespaces must be not empty\");\n      this.client.core.storage.setItem(\"\".concat(p, \"/namespaces\"), t), this.namespaces = t;\n    }\n  }, {\n    key: \"validateChain\",\n    value: function validateChain(t) {\n      var _ref3 = (t === null || t === void 0 ? void 0 : t.split(\":\")) || [\"\", \"\"],\n        _ref4 = _slicedToArray(_ref3, 2),\n        e = _ref4[0],\n        s = _ref4[1];\n      if (e && !Object.keys(this.namespaces).includes(e)) throw new Error(\"Namespace '\".concat(e, \"' is not configured. Please call connect() first with namespace config.\"));\n      return !e || !s ? y(this.namespaces) : [e, s];\n    }\n  }, {\n    key: \"requestAccounts\",\n    value: function () {\n      var _requestAccounts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12() {\n        var _this$validateChain5, _this$validateChain6, t;\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) switch (_context12.prev = _context12.next) {\n            case 0:\n              _this$validateChain5 = this.validateChain(), _this$validateChain6 = _slicedToArray(_this$validateChain5, 1), t = _this$validateChain6[0];\n              _context12.next = 3;\n              return this.getProvider(t).requestAccounts();\n            case 3:\n              return _context12.abrupt(\"return\", _context12.sent);\n            case 4:\n            case \"end\":\n              return _context12.stop();\n          }\n        }, _callee12, this);\n      }));\n      function requestAccounts() {\n        return _requestAccounts.apply(this, arguments);\n      }\n      return requestAccounts;\n    }()\n  }, {\n    key: \"onChainChanged\",\n    value: function onChainChanged(t, e) {\n      var _this$validateChain7 = this.validateChain(e),\n        _this$validateChain8 = _slicedToArray(_this$validateChain7, 2),\n        s = _this$validateChain8[0],\n        n = _this$validateChain8[1];\n      this.getProvider(s).setDefaultChain(n), this.events.emit(\"chainChanged\", t);\n    }\n  }, {\n    key: \"onConnect\",\n    value: function onConnect() {\n      this.events.emit(\"connect\", {\n        session: this.session\n      });\n    }\n  }, {\n    key: \"cleanup\",\n    value: function () {\n      var _cleanup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) switch (_context13.prev = _context13.next) {\n            case 0:\n              this.session = void 0;\n              _context13.next = 3;\n              return this.cleanupPendingPairings({\n                deletePairings: !0\n              });\n            case 3:\n            case \"end\":\n              return _context13.stop();\n          }\n        }, _callee13, this);\n      }));\n      function cleanup() {\n        return _cleanup.apply(this, arguments);\n      }\n      return cleanup;\n    }()\n  }], [{\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(t) {\n        var e;\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) switch (_context14.prev = _context14.next) {\n            case 0:\n              e = new o(t);\n              _context14.next = 3;\n              return e.initialize();\n            case 3:\n              return _context14.abrupt(\"return\", e);\n            case 4:\n            case \"end\":\n              return _context14.stop();\n          }\n        }, _callee14);\n      }));\n      function init(_x7) {\n        return _init.apply(this, arguments);\n      }\n      return init;\n    }()\n  }]);\n  return o;\n}();\nvar U = o;\nexport { U as UniversalProvider, o as default };","map":{"version":3,"mappings":"","names":[],"sources":[],"sourcesContent":["import m from\"pino\";import f from\"@walletconnect/sign-client\";import{getSdkError as g,isValidArray as P}from\"@walletconnect/utils\";import{getDefaultLoggerOptions as w}from\"@walletconnect/logger\";import{JsonRpcProvider as a}from\"@walletconnect/jsonrpc-provider\";import c,{HttpConnection as C}from\"@walletconnect/jsonrpc-http-connection\";import I from\"events\";function y(i){var t;const e=(t=i[Object.keys(i)[0]])==null?void 0:t.chains[0];return[e.split(\":\")[0],e.split(\":\")[1]]}function r(i,t){let e;return t.rpcMap&&(e=t.rpcMap[O([i])]),e}function O(i){return Number(i[0].split(\":\")[1])}class E{constructor(t){this.name=\"eip155\",this.namespace=t.namespace,this.client=t.client,this.events=t.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(t){var e;switch(t.request.method){case\"eth_requestAccounts\":return this.getAccounts();case\"eth_accounts\":return this.getAccounts();case\"wallet_switchEthereumChain\":{const s=t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:\"0x0\";return this.setDefaultChain(parseInt(s,16).toString()),null}case\"eth_chainId\":return this.getDefaultChainId()}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){if(this.chainId=parseInt(t),!this.httpProviders[t]){const s=e||r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(\"chainChanged\",this.chainId)}requestAccounts(){return this.getAccounts()}createHttpProvider(t,e){const s=e||r(t,this.namespace);return typeof s>\"u\"?void 0:new a(new C(s))}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{t[e]=this.createHttpProvider(e)}),t}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(\":\")[1]===this.chainId.toString()).map(e=>e.split(\":\")[2])||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const t=this.namespace.chains[0];if(!t)throw new Error(\"ChainId not found\");return parseInt(t.split(\":\")[1])}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>\"u\")throw new Error(`JSON-RPC provider for ${t} not found`);return e}}class q{constructor(t){this.name=\"solana\",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(\":\")[1]===this.chainId.toString()).map(e=>e.split(\":\")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{t[e]=this.createHttpProvider(e)}),t}getDefaultChainId(){if(this.chainId)return this.chainId;const t=this.namespace.chains[0];if(!t)throw new Error(\"ChainId not found\");return t.split(\":\")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>\"u\")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(\"chainChanged\",this.chainId)}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||r(t,this.namespace);return typeof s>\"u\"?void 0:new a(new c(s))}}class H{constructor(t){this.name=\"cosmos\",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(\":\")[1]===this.chainId.toString()).map(e=>e.split(\":\")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{t[e]=this.createHttpProvider(e)}),t}getDefaultChainId(){if(this.chainId)return this.chainId;const t=this.namespace.chains[0];if(!t)throw new Error(\"ChainId not found\");return t.split(\":\")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>\"u\")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(\"chainChanged\",this.chainId)}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||r(t,this.namespace);return typeof s>\"u\"?void 0:new a(new c(s))}}class ${constructor(t){this.name=\"cip34\",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(\":\")[1]===this.chainId.toString()).map(e=>e.split(\":\")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{t[e]=this.createHttpProvider(e)}),t}getDefaultChainId(){if(this.chainId)return this.chainId;const t=this.namespace.chains[0];if(!t)throw new Error(\"ChainId not found\");return t.split(\":\")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>\"u\")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const s=e||r(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(\"chainChanged\",this.chainId)}setHttpProvider(t,e){const s=this.createHttpProvider(t,e);s&&(this.httpProviders[t]=s)}createHttpProvider(t,e){const s=e||r(t,this.namespace);return typeof s>\"u\"?void 0:new a(new c(s))}}const h=\"error\",b=\"wss://relay.walletconnect.com\",S=\"wc\",A=\"universal_provider\",p=`${S}@${2}:${A}:`;var N=Object.defineProperty,D=Object.defineProperties,j=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,l=(i,t,e)=>t in i?N(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,u=(i,t)=>{for(var e in t||(t={}))k.call(t,e)&&l(i,e,t[e]);if(d)for(var e of d(t))R.call(t,e)&&l(i,e,t[e]);return i},_=(i,t)=>D(i,j(t));class o{constructor(t){this.events=new I,this.rpcProviders={},this.providerOpts=t,this.logger=typeof t?.logger<\"u\"&&typeof t?.logger!=\"string\"?t.logger:m(w({level:t?.logger||h}))}static async init(t){const e=new o(t);return await e.initialize(),e}async request(t,e){const[s,n]=this.validateChain(e);if(!this.session)throw new Error(\"Please call connect() before request()\");return await this.getProvider(s).request({request:u({},t),chainId:`${s}:${n}`,topic:this.session.topic})}sendAsync(t,e,s){this.request(t,s).then(n=>e(null,n)).catch(n=>e(n,void 0))}async enable(){if(!this.client)throw new Error(\"Sign Client not initialized\");return this.session||await this.connect({namespaces:this.namespaces}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error(\"Please call connect() before enable()\");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:g(\"USER_DISCONNECTED\")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error(\"Sign Client not initialized\");const{namespaces:e}=t;return this.setNamespaces(e),this.createProviders(),await this.cleanupPendingPairings(),t.skipPairing===!0?void 0:await this.pair(t.pairingTopic)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){const{uri:e,approval:s}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces});return e&&(this.uri=e,this.events.emit(\"display_uri\",e)),this.session=await s(),this.onSessionUpdate(),this.onConnect(),this.session}setDefaultChain(t,e){try{const[s,n]=this.validateChain(t);this.getProvider(s).setDefaultChain(n,e)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info(\"Cleaning up inactive pairings...\");const e=this.client.pairing.getAll();if(P(e)){for(const s of e)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${p}/namespaces`)||{},this.namespaces&&this.createProviders(),this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.onSessionUpdate()}}async initialize(){this.logger.trace(\"Initialized\"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await f.init({logger:this.providerOpts.logger||h,relayUrl:this.providerOpts.relayUrl||b,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace(\"SignClient Initialized\")}createProviders(){if(!this.client)throw new Error(\"Sign Client not initialized\");Object.keys(this.namespaces).forEach(t=>{switch(t){case\"eip155\":this.rpcProviders[t]=new E({client:this.client,namespace:this.namespaces[t],events:this.events});break;case\"solana\":this.rpcProviders[t]=new q({client:this.client,namespace:this.namespaces[t],events:this.events});break;case\"cosmos\":this.rpcProviders[t]=new H({client:this.client,namespace:this.namespaces[t],events:this.events});break;case\"polkadot\":break;case\"cip34\":this.rpcProviders[t]=new $({client:this.client,namespace:this.namespaces[t],events:this.events});break}})}registerEventListeners(){if(typeof this.client>\"u\")throw new Error(\"Sign Client is not initialized\");this.client.on(\"session_ping\",t=>{this.events.emit(\"session_ping\",t)}),this.client.on(\"session_event\",t=>{const{params:e}=t,{event:s}=e;s.name===\"accountsChanged\"?this.events.emit(\"accountsChanged\",s.data):s.name===\"chainChanged\"?this.onChainChanged(s.data,e.chainId):this.events.emit(s.name,s.data),this.events.emit(\"session_event\",t)}),this.client.on(\"session_update\",({topic:t,params:e})=>{var s;const{namespaces:n}=e,v=(s=this.client)==null?void 0:s.session.get(t);this.session=_(u({},v),{namespaces:n}),this.onSessionUpdate(),this.events.emit(\"session_update\",{topic:t,params:e})}),this.client.on(\"session_delete\",async t=>{await this.cleanup(),this.events.emit(\"session_delete\",t)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var e;this.getProvider(t).updateNamespace((e=this.session)==null?void 0:e.namespaces[t])})}setNamespaces(t){if(!t||!Object.keys(t).length)throw new Error(\"Namespaces must be not empty\");this.client.core.storage.setItem(`${p}/namespaces`,t),this.namespaces=t}validateChain(t){const[e,s]=t?.split(\":\")||[\"\",\"\"];if(e&&!Object.keys(this.namespaces).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);return!e||!s?y(this.namespaces):[e,s]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,e){const[s,n]=this.validateChain(e);this.getProvider(s).setDefaultChain(n),this.events.emit(\"chainChanged\",t)}onConnect(){this.events.emit(\"connect\",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}}const U=o;export{U as UniversalProvider,o as default};\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}