{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/paete/Prototype/nftmusicProtoCopy/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useReducer,useCallback,useEffect,useState}from\"react\";import Web3 from\"web3\";import EthContext from\"./EthContext\";import{reducer,actions,initialState}from\"./state\";import WalletConnectProvdier from\"@walletconnect/web3-provider\";import{infuraProvider}from'wagmi/providers/infura';import{Web3Button}from\"@web3modal/react\";import{EthereumClient,modalConnectors,walletConnectProvider}from\"@web3modal/ethereum\";import{Web3Modal}from\"@web3modal/react\";import{configureChains,createClient,WagmiConfig}from\"wagmi\";import{goerli}from\"wagmi\";import{jsx as _jsx}from\"react/jsx-runtime\";var newjson=[];export function EthProvider(_ref){var children=_ref.children;var _useReducer=useReducer(reducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var chains=[goerli];var _configureChains=configureChains(chains,[walletConnectProvider({projectId:\"251542da3c8552393e55d6d3b636127e\"})]),provider=_configureChains.provider;var wagmiClient=createClient({autoConnect:true,connectors:modalConnectors({projectId:\"251542da3c8552393e55d6d3b636127e\",version:\"1\",// or \"2\"\nchains:chains}),provider:provider});// Web3Modal Ethereum Client\nvar ethereumClient=new EthereumClient(wagmiClient,chains);//  const provider3 = new WalletConnectProvdier({\n//   rpc: {\n//     5:'https://goerli.infura.io/v3/ff2d998f9cdf4be29197ce3ffb727d89'\n//   },\n//   infuraId: \"ff2d998f9cdf4be29197ce3ffb727d89\",\n//  qrcodeModalOptions: {\n//    desktopLinks: [\n//      'ledger',\n//      'tokenary',\n//      'wallet',\n//      'wallet 3',\n//      'secuX',\n//      'ambire',\n//      'wallet3',\n//      'apolloX',\n//      'zerion',\n//      'sequence',\n//      'punkWallet',\n//      'kryptoGO',\n//      'nft',\n//      'riceWallet',\n//      'vision',\n//      'keyring'\n//    ],\n//    mobileLinks: [\n//      \"rainbow\",\n//      \"metamask\",\n//      \"argent\",\n//      \"trust\",\n//      \"imtoken\",\n//      \"pillar\",\n//    ],}});\nvar init=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(artifact){var web3,accounts,networkID,abi,address,contract;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!artifact){_context.next=13;break;}// const web3 = new Web3(Web3.givenProvider || \"ws://127.0.0.1:7545\");\n// await provider.disconnect();            \n// await provider3.enable();\n//  const web3 = new Web3(provider);\nweb3=new Web3(window.web3.currentProvider);_context.next=4;return window.web3.currentProvider.enable();case 4:_context.next=6;return web3.eth.getAccounts();case 6:accounts=_context.sent;_context.next=9;return web3.eth.net.getId();case 9:networkID=_context.sent;abi=artifact.abi;try{address=artifact.networks[networkID].address;contract=new web3.eth.Contract(abi,address);}catch(err){console.error(err);console.log(\"에러위치\");}dispatch({type:actions.init,data:{artifact:artifact,web3:web3,accounts:accounts,networkID:networkID,contract:contract,newjson:newjson,provider:provider}});case 13:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[]);useEffect(function(){var tryInit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var artifact;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:try{artifact=require(\"../../contracts/ArtGrowNFT.json\");init(artifact);}catch(err){console.error(err);}case 1:case\"end\":return _context2.stop();}},_callee2);}));return function tryInit(){return _ref3.apply(this,arguments);};}();tryInit();},[init]);useEffect(function(){var events=[\"chainChanged\",\"accountsChanged\"];var handleChange=function handleChange(){init(state.artifact);};events.forEach(function(e){return window.ethereum.on(e,handleChange);});return function(){events.forEach(function(e){return window.ethereum.removeListener(e,handleChange);});};},[init,state.artifact]);return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(EthContext.Provider,{value:{state:state,dispatch:dispatch},children:children})});}export default EthProvider;","map":{"version":3,"names":["React","useReducer","useCallback","useEffect","useState","Web3","EthContext","reducer","actions","initialState","WalletConnectProvdier","infuraProvider","Web3Button","EthereumClient","modalConnectors","walletConnectProvider","Web3Modal","configureChains","createClient","WagmiConfig","goerli","newjson","EthProvider","children","state","dispatch","chains","projectId","provider","wagmiClient","autoConnect","connectors","version","ethereumClient","init","artifact","web3","window","currentProvider","enable","eth","getAccounts","accounts","net","getId","networkID","abi","address","networks","contract","Contract","err","console","error","log","type","data","tryInit","require","events","handleChange","forEach","e","ethereum","on","removeListener"],"sources":["C:/Users/paete/Prototype/nftmusicProtoCopy/client/src/contexts/EthContext/EthProvider.jsx"],"sourcesContent":["import React, { useReducer, useCallback, useEffect, useState } from \"react\";\nimport Web3 from \"web3\";\nimport EthContext from \"./EthContext\";\nimport { reducer, actions, initialState } from \"./state\";\nimport WalletConnectProvdier from \"@walletconnect/web3-provider\";\nimport { infuraProvider } from 'wagmi/providers/infura'\nimport { Web3Button } from \"@web3modal/react\";\n\nimport {\n  EthereumClient,\n  modalConnectors,\n  walletConnectProvider,\n} from \"@web3modal/ethereum\";\n\nimport { Web3Modal } from \"@web3modal/react\";\nimport { configureChains, createClient, WagmiConfig } from \"wagmi\";\nimport { goerli } from \"wagmi\";\nvar newjson=[]\n\nexport  function EthProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const chains =[goerli];\n\nconst {provider} = configureChains(chains,[\n  walletConnectProvider({ projectId: \"251542da3c8552393e55d6d3b636127e\" }),\n]);\n\nconst wagmiClient = createClient({\n  autoConnect: true,\n  connectors: modalConnectors({\n    projectId: \"251542da3c8552393e55d6d3b636127e\",\n    version: \"1\", // or \"2\"\n    chains,\n  }),\n  provider,\n});\n\n// Web3Modal Ethereum Client\nconst ethereumClient = new EthereumClient(wagmiClient,chains);\n\n//  const provider3 = new WalletConnectProvdier({\n  \n//   rpc: {\n//     5:'https://goerli.infura.io/v3/ff2d998f9cdf4be29197ce3ffb727d89'\n    \n//   },\n//   infuraId: \"ff2d998f9cdf4be29197ce3ffb727d89\",\n  \n \n//  qrcodeModalOptions: {\n//    desktopLinks: [\n//      'ledger',\n//      'tokenary',\n//      'wallet',\n//      'wallet 3',\n//      'secuX',\n//      'ambire',\n//      'wallet3',\n//      'apolloX',\n//      'zerion',\n//      'sequence',\n//      'punkWallet',\n//      'kryptoGO',\n//      'nft',\n//      'riceWallet',\n//      'vision',\n//      'keyring'\n//    ],\n//    mobileLinks: [\n//      \"rainbow\",\n//      \"metamask\",\n//      \"argent\",\n//      \"trust\",\n//      \"imtoken\",\n//      \"pillar\",\n     \n//    ],}});\n\n\n\n  const init = useCallback(\n    async artifact => {\n      \n      if (artifact) {   \n        // const web3 = new Web3(Web3.givenProvider || \"ws://127.0.0.1:7545\");\n            \n  // await provider.disconnect();            \n  // await provider3.enable();\n  \n  //  const web3 = new Web3(provider);\n  \n  const web3 = new Web3(window.web3.currentProvider);\n  await window.web3.currentProvider.enable();\n\n\n\n \n        \n        // const web3 = new Web3(Web3.givenProvider || \"ws://goerli.infura.io/v3/ff2d998f9cdf4be29197ce3ffb727d89\");\n        const accounts = await web3.eth.getAccounts();\n        const networkID = await web3.eth.net.getId();\n       \n        const { abi } = artifact;\n        let address, contract;\n        try {\n          address = artifact.networks[networkID].address;\n          contract = new web3.eth.Contract(abi, address);   \n          \n        } catch (err) {\n          console.error(err);\n          console.log(\"에러위치\");\n        }\n        dispatch({\n          type: actions.init,\n          data: { artifact, web3, accounts, networkID, contract,newjson,provider}\n        });\n      }\n    }, []);\n\n  \n \n    \n   \n  useEffect(() => {\n    const tryInit = async () => {\n      try {\n        const artifact = require(\"../../contracts/ArtGrowNFT.json\");\n        init(artifact);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    tryInit();\n  }, [init]);\n\n  \n\n  useEffect(() => {\n    const events = [\"chainChanged\", \"accountsChanged\"];\n    const handleChange = () => {\n      init(state.artifact);\n\n    };\n    events.forEach(e => window.ethereum.on(e, handleChange));\n    return () => {\n      events.forEach(e => window.ethereum.removeListener(e, handleChange));\n    };\n  }, [init,state.artifact]);\n\n  \n \n  \n\n  return (\n    \n     <React.Fragment>\n       <EthContext.Provider value={{\n      state,\n      dispatch\n    }}>\n      \n      {children}\n     \n  \n    </EthContext.Provider>\n    \n     </React.Fragment>\n\n\n  );\n}\n\n\nexport default EthProvider;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}